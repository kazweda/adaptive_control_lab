# adaptive_control_lab

Flutter ã‚’ç”¨ã„ãŸ **åˆ¶å¾¡ç³»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å¯è¦–åŒ–ã‚¢ãƒ—ãƒª**ã€‚

æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€  
**PID åˆ¶å¾¡** ã¨ **Self-Tuning Regulatorï¼ˆSTRï¼‰** ã‚’åŒä¸€ãƒ—ãƒ©ãƒ³ãƒˆä¸Šã§æ¯”è¼ƒã—ã€
åˆ¶å¾¡æ€§èƒ½ãƒ»é©å¿œæ€§ã®é•ã„ã‚’è¦–è¦šçš„ã«ç†è§£ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã™ã‚‹ã€‚

---

## ğŸŒ Web Demo

> **[Demo ã‚µã‚¤ãƒˆ](https://kazweda.github.io/adaptive_control_lab/)** ã§ä»Šã™ããŠè©¦ã—ãã ã•ã„ï¼  
> ãƒ–ãƒ©ã‚¦ã‚¶ã®ã¿ã§å‹•ä½œã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã§ã™ã€‚

---

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **[é–‹ç™ºæ‰‹é †ã‚¬ã‚¤ãƒ‰](docs/DEVELOPMENT.md)** - é–‹ç™ºãƒ•ãƒ­ãƒ¼ã€PRä½œæˆæ‰‹é †
- **[ã‚³ãƒ¼ãƒ‰å“è³ªãƒãƒªã‚·ãƒ¼](docs/QUALITY_POLICY.md)** - ãƒ†ã‚¹ãƒˆã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°åŸºæº–

---

## Features

- é›¢æ•£æ™‚é–“ãƒ—ãƒ©ãƒ³ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ1æ¬¡ / 2æ¬¡ç³»ï¼‰
- PID åˆ¶å¾¡ï¼ˆå›ºå®šã‚²ã‚¤ãƒ³ï¼‰
- Self-Tuning Regulatorï¼ˆRLS ã«ã‚ˆã‚‹ã‚ªãƒ³ãƒ©ã‚¤ãƒ³åŒå®šï¼‰
- ç›®æ¨™å€¤è¿½å¾“ãƒ»å¤–ä¹±å¿œç­”ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¯è¦–åŒ–
- ãƒ—ãƒ©ãƒ³ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹•çš„å¤‰æ›´

---

## Control Models

### Plant Model (Discrete Time)

```math
y(k) = a_1 y(k-1) + a_2 y(k-2) + b_1 u(k-1)
```

- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å®Ÿè¡Œä¸­ã«å¤‰æ›´å¯èƒ½
- ãƒ¢ãƒ‡ãƒ«ä¸ä¸€è‡´ãƒ»å¤–ä¹±ã®å†ç¾ã‚’ç›®çš„ã¨ã™ã‚‹

---

### PID Controller

```math
u(k) = K_p e(k) + K_i \sum e(k) + K_d (e(k) - e(k-1))
```

- ã‚²ã‚¤ãƒ³ã¯ UI ã‹ã‚‰æ‰‹å‹•èª¿æ•´
- ãƒ—ãƒ©ãƒ³ãƒˆå¤‰å‹•ã«å¯¾ã—ã¦ã¯éé©å¿œ

---

### Self-Tuning Regulator (STR)

#### Identification Model (ARX)

```math
y(k) = \hat a_1 y(k-1) + \hat a_2 y(k-2) + \hat b_1 u(k-1)
```

#### Parameter Estimation

- Recursive Least Squares (RLS)
- Forgetting factor å¯¾å¿œäºˆå®š

#### Control Law

- æ¥µé…ç½®ãƒ™ãƒ¼ã‚¹
- åŒå®šçµæœã‹ã‚‰åˆ¶å¾¡å…¥åŠ›ã‚’é€æ¬¡æ›´æ–°

---

## Project Structure

```
lib/
 â”œ control/
 â”‚   â”œ plant.dart        // ãƒ—ãƒ©ãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«
 â”‚   â”œ pid.dart          // PIDåˆ¶å¾¡å™¨
 â”‚   â”œ str.dart          // STRåˆ¶å¾¡å™¨
 â”‚   â”” rls.dart          // RLSåŒå®šãƒ­ã‚¸ãƒƒã‚¯
 â”‚
 â”œ simulation/
 â”‚   â”” simulator.dart   // æ™‚é–“æ›´æ–°ãƒ»çŠ¶æ…‹ç®¡ç†
 â”‚
 â”œ ui/
 â”‚   â”œ plot.dart         // æ™‚ç³»åˆ—ã‚°ãƒ©ãƒ•
 â”‚   â”œ control_panel.dart
 â”‚   â”” main_screen.dart
 â”‚
 â”” main.dart
```

---

## Simulation Loop

- Fixed interval discrete-time simulation
- `Timer.periodic` ã¾ãŸã¯ `Ticker` ã‚’ä½¿ç”¨

```dart
Timer.periodic(const Duration(milliseconds: 50), (_) {
  simulator.step();
});
```

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç²¾åº¦ã‚ˆã‚Šã‚‚ **æŒ™å‹•ã®åˆ†ã‹ã‚Šã‚„ã™ã•** ã‚’å„ªå…ˆã™ã‚‹ã€‚

---

## Visualization

- Reference vs Output
- Control input
- Estimated parameters (STR)

STR ã®é©å¿œéç¨‹ãŒè¦–è¦šçš„ã«ç¢ºèªã§ãã‚‹ã“ã¨ã‚’é‡è¦–ã™ã‚‹ã€‚

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
flutter test

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
flutter test --coverage

# ã‚³ãƒ¼ãƒ‰è§£æ
flutter analyze
```

### ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

- `lib/control/`: âœ… 90%ä»¥ä¸Š
- `lib/simulation/`: âœ… 90%ä»¥ä¸Š
- `lib/ui/`: âš ï¸ éƒ¨åˆ†çš„

---

## Roadmap

- [x] 1æ¬¡ç³» + PID
- [x] 2æ¬¡ç³» + å¤–ä¹±
- [x] Flutter Web å¯¾å¿œ
- [ ] RLS åŒå®š
- [ ] STR å®Ÿè£…
- [ ] ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³èª²é¡Œï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ã€è»Šä¸¡é€Ÿåº¦åˆ¶å¾¡ãªã©ï¼‰

---

## Goal

åˆ¶å¾¡ç†è«–ã®ç†è§£ã‚’æ·±ã‚ã‚‹ãŸã‚ã®  
**å®Ÿé¨“å¯èƒ½ãƒ»ç›´æ„Ÿçš„ãƒ»æ‹¡å¼µå¯èƒ½** ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ã€‚
