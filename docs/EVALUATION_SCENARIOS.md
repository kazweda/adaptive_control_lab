# 評価シナリオ（初学者向け）

このドキュメントでは、制御性能を直感的に理解できる代表的なシナリオを提供します。

---

## 評価軸

制御性能の良し悪しを判断する指標:

- **立ち上がり・整定時間** - 目標値に到達し安定するまでの速さ
- **オーバーシュート** - 目標値を超えて行き過ぎる量
- **定常偏差** - 最終的に残る誤差
- **振動・発散の有無** - システムの安定性
- **外乱後の収束時間** - 外乱を受けた後の回復力

---

## 1次プラントのシナリオ

プラントモデル: `y(k) = a·y(k-1) + b·u(k-1)`

### 1. 成功パターン（理想的な応答）

**パラメータ**
- プラント: `a=0.6`, `b=0.7`
- PIDゲイン: `Kp=0.6`, `Ki=0.15`, `Kd=0.05`

**期待される挙動**
- 速く整定する
- オーバーシュートが小さい
- 安定した応答

---

### 2. 安全・遅めパターン

**パラメータ**
- プラント: `a=0.8`, `b=0.5`
- PIDゲイン: `Kp=0.25`, `Ki=0.05`, `Kd=0.0`

**期待される挙動**
- オーバーシュートほぼゼロ
- 応答は遅いが非常に安定
- 保守的な制御の典型例

---

### 3. オーバーシュート例

**パラメータ**
- プラント: `a=0.8`, `b=0.5`
- PIDゲイン: `Kp=1.0`, `Ki=0.2`, `Kd=0.0`

**期待される挙動**
- 目標値を大きく行き過ぎる
- 数回振動してから整定
- Kpが過大な場合の典型的な挙動

---

### 4. 発散寄りパターン（危険例）

**パラメータ**
- プラント: `a=0.9`, `b=0.4`
- PIDゲイン: `Kp=1.2`, `Ki=0.3`, `Kd=0.0`

**期待される挙動**
- 振幅が増大する
- システムが不安定化する危険性
- ゲイン過大による失敗例

---

### 5. 定常偏差が残るパターン

**パラメータ**
- プラント: `a=0.7`, `b=0.4`
- PIDゲイン: `Kp=0.5`, `Ki=0.0`, `Kd=0.05`

**期待される挙動**
- 早く応答するが目標値に届かない
- 積分項（Ki）の必要性を示す例
- 定常偏差の問題を理解するのに最適

---

### 6. ノイズに弱いパターン

**パラメータ**
- プラント: `a=0.6`, `b=0.6`
- PIDゲイン: `Kp=0.5`, `Ki=0.1`, `Kd=0.5`

**期待される挙動**
- 制御入力がギザギザになる
- Kd（微分項）が過大な場合の問題
- ノイズ増幅の典型例

---

## 2次プラントのシナリオ

プラントモデル: `y(k) = a1·y(k-1) + a2·y(k-2) + b1·u(k-1) + b2·u(k-2)`

### 1. 成功パターン

**パラメータ**
- プラント: `a1=1.1`, `a2=-0.3`, `b1=0.5`, `b2=0.1`
- PIDゲイン: `Kp=0.4`, `Ki=0.08`, `Kd=0.08`

**期待される挙動**
- 軽い振動を伴いながら整定
- 2次系の典型的な良好応答

---

### 2. 失敗パターン（減衰不足）

**パラメータ**
- プラント: `a1=1.2`, `a2=-0.32`, `b1=0.45`, `b2=0.08`
- PIDゲイン: `Kp=0.8`, `Ki=0.15`, `Kd=0.0`

**期待される挙動**
- 振動が長時間続く
- 減衰が不十分
- 2次系でのゲイン調整の難しさを示す例

---

## 外乱応答シナリオ

外乱プリセットを活用した評価パターン。

### ステップ外乱

**早期ステップ外乱** (`step_early`)
- タイミング: 10ステップ目
- 振幅: 0.2
- 用途: 立ち上がり直後の外乱耐性を確認

**大きなステップ外乱** (`step_large`)
- タイミング: 100ステップ目
- 振幅: 0.5
- 用途: 大外乱からの回復力を評価

---

### インパルス外乱

**小さなインパルス** (`impulse_small`)
- タイミング: 50ステップ目
- 振幅: 0.3
- 用途: 瞬間的な衝撃への応答確認

**大きなインパルス** (`impulse_large`)
- タイミング: 100ステップ目
- 振幅: 1.0
- 用途: 強い衝撃からの復帰性能を評価

---

### サイン波外乱

**中程度のサイン波** (`sinusoid_mid`)
- 角周波数: ω = 0.2 rad/step
- 振幅: 0.2
- 用途: 周期的な外乱への追従性能を確認

**他のバリエーション**
- `sinusoid_slow`: ω = 0.05（ゆっくり）
- `sinusoid_fast`: ω = 0.5（速い）

---

### ノイズ外乱

**中程度のノイズ** (`noise_mid`)
- 標準偏差: 0.05
- シード: 42（再現性確保）
- 用途: センサノイズ等への耐性評価

**他のバリエーション**
- `noise_small`: std = 0.03（小さい）
- `noise_large`: std = 0.1（大きい）

---

## 簡易チェックリスト

PIDゲインの影響を素早く確認するためのガイド:

| ゲイン | 過大な場合の症状 | 不足の場合の症状 |
|--------|-----------------|----------------|
| **Kp** | オーバーシュート・振動 | 応答が遅い、定常偏差大 |
| **Ki** | 遅い振動／発散 | 定常偏差が残る |
| **Kd** | ノイズ増幅でギザギザ | オーバーシュート大 |

**2次プラント特有の注意点**
- 減衰不足: 振動が長時間続く
- ゲイン調整がより難しい
- Kdの効果がより顕著

---

## 評価方法の推奨手順

1. **ベースライン確立**: 成功パターンでシステムの正常動作を確認
2. **パラメータスイープ**: 各ゲインを段階的に変化させて影響を観察
3. **外乱応答**: プリセットを使って外乱後の整定時間を比較
4. **記録と比較**: オーバーシュート、整定時間を数値化して記録
5. **STR比較**: 同じシナリオでSTRの適応性能を評価

---

## まとめ

これらのシナリオを通じて、以下を体験的に理解できます:

- PIDゲインの役割と調整の難しさ
- プラントパラメータ変化の影響
- 外乱に対するロバスト性
- 1次系と2次系の挙動の違い
- STRによる適応制御の効果

実際にシミュレーションを実行し、パラメータを変えながら試行錯誤することで、
制御理論の理解を深めることができます。
